# Псионическая система - Реализация

## Обзор

Полная реализация псионической системы для тактической боевой системы XCOM2, включающая все четыре запрошенные способности из TODO.

## Реализованные способности

### 1. TELEPORT (Телепортация)
- **Описание**: Мгновенное перемещение юнита на позицию цели
- **Стоимость**: 15 пси-энергии
- **Дальность**: 8 клеток (с модификатором x3 = 24 клетки)
- **Кулдаун**: 5 ходов
- **Эффект**: Мгновенное перемещение кастера на позицию цели

### 2. PSYCHIC_DOMINANCE (Контроль роботов)
- **Описание**: Взятие под контроль роботизированных юнитов
- **Стоимость**: 12 пси-энергии
- **Дальность**: 6 клеток (с модификатором x1.5 = 9 клеток)
- **Кулдаун**: 4 хода
- **Эффект**: Контроль роботизированных юнитов (UnitType.ROBOTIC)
- **Особенность**: Работает только против роботизированных юнитов

### 3. MIND_MERGE (Слияние сознания)
- **Описание**: Слияние сознания между союзниками
- **Стоимость**: 8 пси-энергии
- **Дальность**: 5 клеток
- **Кулдаун**: 3 хода
- **Длительность**: 4 хода
- **Эффект**: Слияние сознания между кастером и целью

### 4. PSYCHIC_BARRIER (Псионический барьер)
- **Описание**: Создание защитного псионического барьера
- **Стоимость**: 5 пси-энергии
- **Дальность**: 3 клетки (с модификатором /2 = 1.5 клетки)
- **Кулдаун**: 2 хода
- **Длительность**: 5 ходов
- **Эффект**: Создание защитного барьера с высоким эффектом защиты

## Архитектура реализации

### Основные компоненты

#### 1. PsionicAbility (Базовый класс способностей)
```java
public class PsionicAbility {
    private String name;
    private PsionicType psionicType;
    private int psiCost;
    private int range;
    private int cooldown;
    private int duration;
    private int intensity;
    // ... методы для использования способностей
}
```

#### 2. PsionicAbilityFactory (Фабрика способностей)
```java
public class PsionicAbilityFactory {
    public static PsionicAbility createTeleport()
    public static PsionicAbility createPsychicDominance()
    public static PsionicAbility createEnhancedMindMerge()
    public static PsionicAbility createEnhancedPsychicBarrier()
    // ... другие методы создания способностей
}
```

#### 3. PsionicSystemManager (Управление системой)
```java
public class PsionicSystemManager {
    private Map<String, PsionicAbility> availableAbilities;
    private Map<String, List<PsionicAbility>> unitAbilities;
    private Map<String, Integer> unitPsiEnergy;
    // ... методы управления псионической системой
}
```

### Интеграция с боевой системой

#### AdvancedXCOM2CombatManager
- Добавлены методы для обработки всех псионических способностей
- Интеграция с системой статус-эффектов
- Поддержка проверок дальности и энергии

#### UltimateCombatManager
- Расширенная обработка псионических эффектов
- Интеграция с системой пси-силы и сопротивления
- Поддержка всех типов псионических способностей

## Новые статус-эффекты

Добавлены новые статус-эффекты для поддержки псионических способностей:

```java
public enum StatusEffect {
    // ... существующие эффекты
    CONTROLLED,     // Unit is under mind control
    MIND_MERGED,    // Unit is in mind merge state
    DOMINATED,      // Unit is dominated by psionic power
    PSYCHIC_SHIELD, // Unit has psychic shield protection
    MIND_SHIELD     // Unit has mind shield protection
}
```

## Новые типы юнитов

Добавлен новый тип юнита для поддержки псионического доминирования:

```java
public enum UnitType {
    // ... существующие типы
    ROBOTIC         // Robotic unit (can be controlled by psychic dominance)
}
```

## Система пси-энергии

### Управление энергией
- **Регистрация юнитов** с начальной пси-энергией
- **Регенерация энергии** каждый ход
- **Проверка достаточности** энергии для использования способностей
- **Ограничения по емкости** пси-энергии

### Модификаторы эффектов
- **TELEPORT**: x4 к базовому эффекту (очень высокий эффект)
- **PSYCHIC_DOMINANCE**: x3 к базовому эффекту (высокий эффект)
- **MIND_MERGE**: x2 к базовому эффекту (умеренный эффект)
- **PSYCHIC_BARRIER**: x3 к базовому эффекту (высокий эффект защиты)

## Тестирование

Создан тестовый класс `PsionicSystemTest` для проверки:
- Создания псионических способностей
- Работы фабрики способностей
- Управления псионической системой
- Регистрации юнитов и разблокировки способностей

## Производительность

### Оптимизации
- **Кэширование способностей** в фабрике
- **Эффективные проверки** доступности способностей
- **Оптимизированные структуры данных** для управления эффектами
- **Минимальные накладные расходы** при использовании способностей

### Масштабируемость
- Поддержка неограниченного количества юнитов с псионическими способностями
- Эффективное управление кулдаунами и эффектами
- Возможность добавления новых псионических способностей

## Будущие расширения

### Возможные улучшения
1. **Визуальные эффекты** для псионических способностей
2. **Звуковые эффекты** и аудио-обратная связь
3. **Анимации** использования способностей
4. **Система обучения** псионическим способностям
5. **Комбинации способностей** и синергии

### Архитектурные возможности
- Легкое добавление новых псионических способностей
- Расширение системы статус-эффектов
- Интеграция с системой миссий и кампаний
- Поддержка мультиплеера

## Заключение

Псионическая система полностью реализована и интегрирована в тактическую боевую систему. Все четыре запрошенные способности из TODO реализованы с полной функциональностью:

✅ **TELEPORT** - мгновенное перемещение  
✅ **PSYCHIC_DOMINANCE** - контроль роботов  
✅ **MIND_MERGE** - слияние сознания  
✅ **PSYCHIC_BARRIER** - защитный барьер  

Система готова к использованию и дальнейшему расширению.
